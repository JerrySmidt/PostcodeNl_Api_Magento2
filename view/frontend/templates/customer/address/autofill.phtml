<?php
/**
 * @var $block \PostcodeEu\AddressValidation\Block\Customer\Address\Autofill
 * @var \Magento\Framework\Escaper $escaper
 */
?>
<div id="block-loader-customer-address" data-role="customer-address-loader" class="loading-mask loading-mask-customer-address">
    <div class="loader">
        <img src="<?= /* @noEscape */ $block->getViewFileUrl('images/loader-1.gif') ?>"
            alt="<?= $escaper->escapeHtml(__('Loading...')) ?>" style="position: absolute;">
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const formValidate = document.querySelector('#form-validate'),
            blockLoader = document.getElementById('block-loader-customer-address');

        if (formValidate && blockLoader) {
            formValidate.appendChild(blockLoader);
        }
    });
</script>

<div class="fieldset address-autofill-fieldset" data-bind="scope: 'address_autofill'">
    <!-- ko template: getTemplate() --><!-- /ko -->
</div>

<script type="text/x-magento-init">
    {
        "#block-loader-customer-address": {
            "PostcodeEu_AddressValidation/js/block-loader": {}
        },
        ".address-autofill-fieldset": {
            "Magento_Ui/js/core/app": <?= /* @noEscape */ $block->getJsLayout();?>
        }
    }
</script>
